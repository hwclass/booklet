var Booklet=function(t,e){var n=this;this.name=t,this.defaults="undefined"!=typeof e?e:{};var i=this;this.SERVICES=[],this.TOPICS=[];var r=function(t){var e=this;this.booklet=i,this.defaults=t,this.MODULES=[],this.TOPICS=i.TOPICS,this.SERVICES=[],this.register=function(t,n){e.MODULES.push({name:t,fn:n,started:!1})},this.detach=function(t){var n=e.getModule(t,!0);try{e.MODULES.splice(n.index,1)}catch(i){console.log(i)}},this.start=function(t){var n=e.getModule(t);n.fn&&(n.fn.init(),n.started=!0)},this.startAll=function(){for(var t=0,n=e.MODULES.length;n>t;t++)e.MODULES[t].started||e.start(e.MODULES[t].name)},this.stop=function(t){var n=e.getModule(t);n=null},this.stopAll=function(){for(var t=0,n=e.MODULES.length;n>t;t++)e.MODULES[t].started||e.stop(e.MODULES[t].name)},this.subscribe=function(t,n){e.TOPICS[t]||(e.TOPICS[t]={queue:[]});var i=e.TOPICS[t].queue.push(n);return function(t){return{remove:function(){delete e.TOPICS[t]}}}(i)},this.getModule=function(t,n){for(var i,r,u,s=0,o=e.MODULES.length;o>s;s++)e.MODULES[s].name===t&&(i=e.MODULES[s],r=s);return n&&(i=u={selectedModule:i,index:r}),i},this.createService=function(t,n){e.SERVICES.push({name:t,context:n})},this.getService=function(t){for(var n,i=0,r=e.SERVICES.length;r>i;i++)e.SERVICES[i].name===t&&(n=e.SERVICES[i].context);return n},this.getConfig=function(){return i.config},this.getUtility=function(){return i.utility}};this.createView=function(t,e){var n="undefined"!=typeof e?e:{};return new r(n)},this.createService=function(t,e){n.SERVICES.push({name:t,context:e})},this.getService=function(t){for(var e,i=0,r=n.SERVICES.length;r>i;i++)n.SERVICES[i].name===t&&(e=n.SERVICES[i].context);return e},this.publish=function(t,e){if(n.TOPICS[t]&&n.TOPICS[t].queue.length)for(var i=n.TOPICS[t].queue,r=0;r<i.length;r++)i[r](e||{})}};